(()=>{"use strict";var e={formSelector:".form",inputSelector:".form__input",submittingButtonSelector:".form__submit",inputErrorSelector:".error",submittingButtonInvalid:"form__submit_invalid",inputInvalid:"form__input_invalid",errorVisible:"error_visible"};function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o(r.key),r)}}function r(e,t,n){return(t=o(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){var n=function(e,n){if("object"!==t(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,n);if("object"!==t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"===t(n)?n:String(n)}var i=function(){function e(t,n,o,i,a,l,u){var c=this,s=a.owned,f=a.userId,p=l.handleImageClick,y=l.handleDeletionClick,h=u.api;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r(this,"_toggleLike",(function(){c._likeBtn.classList.contains("element__like_active")?c._api.unlikeCard(c._id).then((function(e){c._likeBtn.classList.remove("element__like_active"),c._likesCount=e.likes.length,c._setLikeCount()})).catch((function(e){console.log(e)})):c._api.likeCard(c._id).then((function(e){c._likeBtn.classList.add("element__like_active"),c._likesCount=e.likes.length,c._setLikeCount()})).catch((function(e){console.log(e)}))})),r(this,"_clickRemove",(function(){c._handleDeletionClick(c._id)})),this._title=t,this._url=n,this._id=o,this._likes=i,this._likesCount=i.length,this._owned=s,this._userId=f,this._api=h,this._templateSelector=".template",this._template=document.querySelector(this._templateSelector).content,this._card=this._template.querySelector(".element").cloneNode(!0),this._text=this._card.querySelector(".element__title"),this._img=this._card.querySelector(".element__image"),this._removeBtn=this._card.querySelector(".element__remove"),this._likeBtn=this._card.querySelector(".element__like"),this._likeCount=this._card.querySelector(".element__like-count"),this._handleImageClick=p,this._handleDeletionClick=y}var t,o;return t=e,(o=[{key:"_createCard",value:function(){this._setEventListeners(),this._insertData(),this._setLikeCount(),this._toggleDeleteBtnIfOwned(),this._checkIfLiked()}},{key:"_setEventListeners",value:function(){var e=this;this._img.addEventListener("click",(function(){e._handleImageClick(e._img.src,e._img.alt,e._text.textContent)})),this._likeBtn.addEventListener("click",this._toggleLike),this._removeBtn.addEventListener("click",this._clickRemove)}},{key:"_checkIfLiked",value:function(){var e=this;this._likes.forEach((function(t){t._id===e._userId&&e._blackenLike()}))}},{key:"_blackenLike",value:function(){this._likeBtn.classList.add("element__like_active")}},{key:"_setLikeCount",value:function(){this._likesCount>0?(this._likeCount.style.display="block",this._likeCount.textContent=this._likesCount):this._likeCount.style.display="none"}},{key:"_toggleDeleteBtnIfOwned",value:function(){this._owned?this._removeBtn.style.display="block":this._removeBtn.style.display="none"}},{key:"deleteCard",value:function(){this._card.remove(),this._template=null,this._card=null}},{key:"_insertData",value:function(){this._img.src=this._url,this._img.alt=this._title,this._text.textContent=this._title}},{key:"getCard",value:function(){return this._createCard(),this._card}}])&&n(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==a(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key,"string"),"symbol"===a(o)?o:String(o)),r)}var o}var u=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._validationData=t,this._validationObject=n,this._submittingButton=this._validationObject.querySelector(this._validationData.submittingButtonSelector),this._inputList=Array.from(this._validationObject.querySelectorAll(this._validationData.inputSelector))}var t,n;return t=e,(n=[{key:"enableValidation",value:function(){this._setEventListener()}},{key:"validateOnOpen",value:function(){var e=this;this._inputList.every((function(e){return""===e.value}))?this._toggleSubmitState():(this._toggleSubmitState(),this._inputList.forEach((function(t){e._checkInputValidity(t)})))}},{key:"_setEventListener",value:function(){var e=this;this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(t),e._toggleSubmitState()}))}))}},{key:"_showInputError",value:function(e,t){var n=this._validationObject.querySelector("#".concat(e.name,"-error"));e.classList.add(this._validationData.inputInvalid),n.classList.add(this._validationData.errorVisible),n.textContent=t}},{key:"_hideInputError",value:function(e){var t=this._validationObject.querySelector("#".concat(e.name,"-error"));e.classList.remove(this._validationData.inputInvalid),t.classList.remove(this._validationData.errorVisible),t.textContent=""}},{key:"_toggleSubmitState",value:function(){this._checkIfAllInputIsValid()?(this._submittingButton.classList.remove(this._validationData.submittingButtonInvalid),this._submittingButton.removeAttribute("disabled")):(this._submittingButton.classList.add(this._validationData.submittingButtonInvalid),this._submittingButton.setAttribute("disabled",!0))}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}},{key:"_checkIfAllInputIsValid",value:function(){return this._inputList.every((function(e){return e.validity.valid}))}}])&&l(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==c(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key,"string"),"symbol"===c(o)?o:String(o)),r)}var o}var f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._selector=t,this._popup=document.querySelector(this._selector),this._popupCloseBtn=this._popup.querySelector(".popup__close-btn"),this._handleEscClose=this._handleEscClose.bind(this)}var t,n;return t=e,(n=[{key:"open",value:function(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}},{key:"setEventListeners",value:function(){var e=this;this._popup.addEventListener("mousedown",(function(t){t.target===t.currentTarget&&e.close()})),this._popupCloseBtn.addEventListener("click",(function(){e.close()}))}},{key:"_handleEscClose",value:function(e){"Escape"===e.key&&this.close()}}])&&s(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==p(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!==p(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key,"string"),"symbol"===p(o)?o:String(o)),r)}var o}function h(){return h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=d(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},h.apply(this,arguments)}function d(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=b(e)););return e}function m(e,t){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},m(e,t)}function _(e,t){if(t&&("object"===p(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=b(r);if(o){var n=b(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return _(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e))._img=t._popup.querySelector(".popup__image"),t._text=t._popup.querySelector(".popup__text"),t}return t=a,(n=[{key:"open",value:function(e,t,n){this._img.src=e,this._img.alt=t,this._text.textContent=n,h(b(a.prototype),"open",this).call(this)}}])&&y(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(f);function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==g(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!==g(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key,"string"),"symbol"===g(o)?o:String(o)),r)}var o}var S=function(){function e(t,n){var r=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._renderer=r,this._container=document.querySelector(n)}var t,n;return t=e,(n=[{key:"renderItems",value:function(e){var t=this;e.forEach((function(e){t._renderer(e)}))}},{key:"addItem",value:function(e,t){"top"===t?this._container.prepend(e):this._container.append(e)}}])&&k(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==w(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!==w(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key,"string"),"symbol"===w(o)?o:String(o)),r)}var o}function j(){return j="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=O(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},j.apply(this,arguments)}function O(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=I(e)););return e}function E(e,t){return E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},E(e,t)}function P(e,t){if(t&&("object"===w(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function I(e){return I=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},I(e)}var L=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=I(r);if(o){var n=I(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return P(this,e)});function a(e,t){var n,r=t.openCallback,o=t.submitCallback;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e))._openCallback=r,n._submitCallback=o,n._form=n._popup.querySelector(".form"),n._formInputs=n._form.querySelectorAll(".form__input"),n}return t=a,(n=[{key:"setEventListeners",value:function(){var e=this;j(I(a.prototype),"setEventListeners",this).call(this),this._form.addEventListener("submit",(function(t){t.preventDefault(),t.stopImmediatePropagation(),e._submitCallback(e._getInputValues())}))}},{key:"changeSumbitHandler",value:function(e){this._submitCallback=e}},{key:"open",value:function(){j(I(a.prototype),"open",this).call(this),this._openCallback()}},{key:"close",value:function(){this._form.reset(),j(I(a.prototype),"close",this).call(this)}},{key:"_getInputValues",value:function(){var e={};return this._formInputs.forEach((function(t){var n=t.name,r=t.value;e[n]=r})),e}}])&&C(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(f);function q(e){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q(e)}function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==q(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!==q(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key,"string"),"symbol"===q(o)?o:String(o)),r)}var o}var x=function(){function e(t){var n=t.profileNameSel,r=t.profileJobSel,o=t.profileImageSel;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._profileName=document.querySelector(n),this._profileJob=document.querySelector(r),this._profileImg=document.querySelector(o)}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){return{name:this._profileName.textContent,job:this._profileJob.textContent}}},{key:"setUserInfo",value:function(e){this._profileName.textContent=e.name,this._profileJob.textContent=e.job}},{key:"setUserImage",value:function(e){this._profileImg.src=e}}])&&T(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==R(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!==R(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key,"string"),"symbol"===R(o)?o:String(o)),r)}var o}var B=new(function(){function e(t){var n=t.baseUrl,r=t.headers;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._baseUrl=n,this._headers=r,this._token=r.authorization}var t,n;return t=e,(n=[{key:"getProfileData",value:function(){return fetch("".concat(this._baseUrl,"/users/me/"),{headers:this._headers}).then(this._checkResponse)}},{key:"setProfileData",value:function(e){return fetch("".concat(this._baseUrl,"/users/me/"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.job})}).then(this._checkResponse)}},{key:"getInitialCards",value:function(){return fetch("".concat(this._baseUrl,"/cards/"),{headers:this._headers}).then(this._checkResponse)}},{key:"addNewCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e.place,link:e.url})}).then(this._checkResponse)}},{key:"deleteCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then(this._checkResponse)}},{key:"likeCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e,"/likes"),{method:"PUT",headers:this._headers}).then(this._checkResponse)}},{key:"unlikeCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e,"/likes"),{method:"DELETE",headers:this._headers}).then(this._checkResponse)}},{key:"getProfileImage",value:function(){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"GET",headers:this._headers}).then(this._checkResponse)}},{key:"updateProfileImage",value:function(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._checkResponse)}},{key:"_checkResponse",value:function(e){return e.ok?e.json():Promise.reject(e.status)}}])&&D(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-55",headers:{authorization:"a110f406-654f-4c53-bae6-3b8905b49b43","Content-Type":"application/json"}});function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var A="",V=document.querySelector(".profile__edit-btn"),N=document.querySelector(".profile__add-btn"),J=document.querySelector(".profile__avatar-box"),H=document.querySelector(".popup_type_edit-profile-img"),z=document.querySelector(".form__input_img"),M=document.querySelector(".form-edit-profile-img"),G=H.querySelector(".form__submit"),$=document.querySelector(".popup_type_edit-card"),F=$.querySelector(".form-edit"),K=$.querySelector(".form__input_field-name"),Q=$.querySelector(".form__input_field-job"),W=$.querySelector(".form__submit"),X=document.querySelector(".popup_type_add-card"),Y=X.querySelector(".form-add"),Z=X.querySelector(".form__submit"),ee=".elements",te=(document.querySelector(ee),new u(e,F)),ne=new u(e,Y),re=new u(e,M),oe=document.querySelector(".popup_type_delete-card").querySelector(".form__submit"),ie=null;te.enableValidation(),ne.enableValidation(),re.enableValidation();var ae=new x({profileNameSel:".profile__name",profileJobSel:".profile__job",profileImageSel:".profile__avatar"});Promise.all([B.getProfileData(),B.getInitialCards()]).then((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],u=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(t,n)||function(e,t){if(e){if("string"==typeof e)return U(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?U(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1];ae.setUserInfo({name:o.name,job:o.about}),ae.setUserImage(o.avatar),A=o._id,function(e){(ie=new S({renderer:function(e){var t=e.owner._id===A,n=pe(e.name,e.link,e._id,e.likes,{owned:t,userId:A});ie.addItem(n,"bottom")}},ee)).renderItems(e)}(i)})).catch((function(e){console.log(e)}));var le=new L(".popup_type_edit-card",{openCallback:function(){var e=ae.getUserInfo();K.value=e.name,Q.value=e.job,te.validateOnOpen()},submitCallback:function(e){W.innerText="Сохранение...",B.setProfileData(e).then((function(){B.getProfileData().then((function(e){ae.setUserInfo({name:e.name,job:e.about})})).catch((function(e){console.log(e)})),le.close()})).catch((function(e){console.log(e)})).finally((function(e){W.innerText="Сохранить"}))}});le.setEventListeners();var ue=new L(".popup_type_add-card",{openCallback:function(){ne.validateOnOpen()},submitCallback:function(e){Z.innerText="Сохранение...",B.addNewCard({place:e.place,url:e.url}).then((function(e){var t=pe(e.name,e.link,e._id,e.likes,{owned:!0,userId:A});ie.addItem(t,"top"),ue.close()})).catch((function(e){console.log(e)})).finally((function(e){Z.innerText="Сохранить"}))}});ue.setEventListeners();var ce=new v(".popup_type_pic");ce.setEventListeners();var se=new L(".popup_type_delete-card",{openCallback:function(){},submitCallback:function(){console.log("New submit handler will be made")}});se.setEventListeners();var fe=new L(".popup_type_edit-profile-img",{openCallback:function(){re.validateOnOpen()},submitCallback:function(){G.innerText="Сохранение...",B.updateProfileImage(z.value).then((function(e){console.log(e),ae.setUserImage(e.avatar),fe.close()})).catch((function(e){console.log(e)})).finally((function(e){G.innerText="Сохранить"}))}});function pe(e,t,n,r,o){var a=o.owned,l=o.userId,u=new i(e,t,n,r,{owned:a,userId:l},{handleImageClick:function(e,t,n){ce.open(e,t,n)},handleDeletionClick:function(e){se.open(),se.changeSumbitHandler((function(){oe.innerText="Удаление...",B.deleteCard(e).then((function(){u.deleteCard(),se.close()})).catch((function(e){console.log(e)})).finally((function(){oe.innerText="Сохранить"}))}))}},{api:B});return u.getCard()}fe.setEventListeners(),V.addEventListener("click",(function(){le.open()})),N.addEventListener("click",(function(){ue.open()})),J.addEventListener("click",(function(){fe.open()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoibUJBQ0EsSUEwQk1BLEVBQWlCLENBQ3JCQyxhQUFjLFFBQ2RDLGNBQWUsZUFDZkMseUJBQTBCLGdCQUMxQkMsbUJBQW9CLFNBQ3BCQyx3QkFBeUIsdUJBQ3pCQyxhQUFjLHNCQUNkQyxhQUFjLGlCLHF6QkNsQ0tDLEVBQUksV0FDdkIsV0FBWUMsRUFBT0MsRUFBS0MsRUFBSUMsRUFBTyxFQUFGLEtBQXlFLFdBQXJFQyxFQUFLLEVBQUxBLE1BQU9DLEVBQU0sRUFBTkEsT0FBWUMsRUFBZ0IsRUFBaEJBLGlCQUFrQkMsRUFBbUIsRUFBbkJBLG9CQUF5QkMsRUFBRyxFQUFIQSxLLDRGQUFHLCtCQXVEeEYsV0FDUixFQUFLQyxTQUFTQyxVQUFVQyxTQUFTLHdCQUNuQyxFQUFLQyxLQUFLQyxXQUFXLEVBQUtDLEtBQ3ZCQyxNQUFLLFNBQUFDLEdBQ0osRUFBS1AsU0FBU0MsVUFBVU8sT0FBTyx3QkFDL0IsRUFBS0MsWUFBY0YsRUFBSWIsTUFBTWdCLE9BQzdCLEVBQUtDLGVBQ1AsSUFDQ0MsT0FBTSxTQUFBQyxHQUNMQyxRQUFRQyxJQUFJRixFQUNkLElBRUYsRUFBS1YsS0FBS2EsU0FBUyxFQUFLWCxLQUNyQkMsTUFBSyxTQUFBQyxHQUNKLEVBQUtQLFNBQVNDLFVBQVVnQixJQUFJLHdCQUM1QixFQUFLUixZQUFjRixFQUFJYixNQUFNZ0IsT0FDN0IsRUFBS0MsZUFDUCxJQUNDQyxPQUFNLFNBQUFDLEdBQ0xDLFFBQVFDLElBQUlGLEVBQ2QsR0FFTixJQUFDLHVCQWlCYyxXQUNiLEVBQUtLLHFCQUFxQixFQUFLYixJQUNqQyxJQS9GRWMsS0FBS0MsT0FBUzdCLEVBQ2Q0QixLQUFLRSxLQUFPN0IsRUFDWjJCLEtBQUtkLElBQU1aLEVBQ1gwQixLQUFLRyxPQUFTNUIsRUFDZHlCLEtBQUtWLFlBQWNmLEVBQU1nQixPQUN6QlMsS0FBS0ksT0FBUzVCLEVBQ2R3QixLQUFLSyxRQUFVNUIsRUFDZnVCLEtBQUtoQixLQUFPSixFQUVab0IsS0FBS00sa0JBQW9CLFlBQ3pCTixLQUFLTyxVQUFZQyxTQUFTQyxjQUFjVCxLQUFLTSxtQkFBbUJJLFFBQ2hFVixLQUFLVyxNQUFRWCxLQUFLTyxVQUFVRSxjQUFjLFlBQVlHLFdBQVUsR0FDaEVaLEtBQUthLE1BQVFiLEtBQUtXLE1BQU1GLGNBQWMsbUJBQ3RDVCxLQUFLYyxLQUFPZCxLQUFLVyxNQUFNRixjQUFjLG1CQUNyQ1QsS0FBS2UsV0FBYWYsS0FBS1csTUFBTUYsY0FBYyxvQkFDM0NULEtBQUtuQixTQUFXbUIsS0FBS1csTUFBTUYsY0FBYyxrQkFDekNULEtBQUtnQixXQUFhaEIsS0FBS1csTUFBTUYsY0FBYyx3QkFFM0NULEtBQUtpQixrQkFBb0J2QyxFQUN6QnNCLEtBQUtELHFCQUF1QnBCLENBQzlCLEMsUUE0RkMsTyxFQTVGQSxHLEVBQUEsMEJBRUQsV0FDRXFCLEtBQUtrQixxQkFDTGxCLEtBQUttQixjQUNMbkIsS0FBS1IsZ0JBQ0xRLEtBQUtvQiwwQkFDTHBCLEtBQUtxQixlQUNQLEdBQUMsZ0NBRUQsV0FBcUIsV0FDbkJyQixLQUFLYyxLQUFLUSxpQkFBaUIsU0FBUyxXQUNsQyxFQUFLTCxrQkFDSCxFQUFLSCxLQUFLUyxJQUNWLEVBQUtULEtBQUtVLElBQ1YsRUFBS1gsTUFBTVksWUFFZixJQUNBekIsS0FBS25CLFNBQVN5QyxpQkFBaUIsUUFBU3RCLEtBQUswQixhQUM3QzFCLEtBQUtlLFdBQVdPLGlCQUFpQixRQUFTdEIsS0FBSzJCLGFBQ2pELEdBQUMsMkJBRUQsV0FBZ0IsV0FDZDNCLEtBQUtHLE9BQU95QixTQUFRLFNBQUNDLEdBQ2ZBLEVBQUszQyxNQUFRLEVBQUttQixTQUNwQixFQUFLeUIsY0FFVCxHQUNGLEdBQUMsMEJBRUQsV0FDRTlCLEtBQUtuQixTQUFTQyxVQUFVZ0IsSUFBSSx1QkFDOUIsR0FBQywyQkEwQkQsV0FDTUUsS0FBS1YsWUFBYyxHQUNyQlUsS0FBS2dCLFdBQVdlLE1BQU1DLFFBQVUsUUFDaENoQyxLQUFLZ0IsV0FBV1MsWUFBY3pCLEtBQUtWLGFBRW5DVSxLQUFLZ0IsV0FBV2UsTUFBTUMsUUFBVSxNQUVwQyxHQUFDLHFDQUVELFdBQ0VoQyxLQUFLSSxPQUNESixLQUFLZSxXQUFXZ0IsTUFBTUMsUUFBVSxRQUNoQ2hDLEtBQUtlLFdBQVdnQixNQUFNQyxRQUFVLE1BQ3RDLEdBQUMsd0JBTUQsV0FDRWhDLEtBQUtXLE1BQU10QixTQUNYVyxLQUFLTyxVQUFZLEtBQ2pCUCxLQUFLVyxNQUFRLElBQ2YsR0FBQyx5QkFFRCxXQUNFWCxLQUFLYyxLQUFLUyxJQUFNdkIsS0FBS0UsS0FDckJGLEtBQUtjLEtBQUtVLElBQU14QixLQUFLQyxPQUNyQkQsS0FBS2EsTUFBTVksWUFBY3pCLEtBQUtDLE1BQ2hDLEdBQUMscUJBRUQsV0FFRSxPQURBRCxLQUFLaUMsY0FDRWpDLEtBQUtXLEtBQ2QsTSxvRUFBQyxFQWxIc0IsRyx5cUJDQUp1QixFQUFhLFdBQ2hDLFdBQWF2RSxFQUFnQndFLEksNEZBQWtCLFNBQzdDbkMsS0FBS29DLGdCQUFrQnpFLEVBQ3ZCcUMsS0FBS3FDLGtCQUFvQkYsRUFDekJuQyxLQUFLc0Msa0JBQW9CdEMsS0FBS3FDLGtCQUFrQjVCLGNBQWNULEtBQUtvQyxnQkFBZ0J0RSwwQkFDbkZrQyxLQUFLdUMsV0FBYUMsTUFBTUMsS0FBS3pDLEtBQUtxQyxrQkFBa0JLLGlCQUFpQjFDLEtBQUtvQyxnQkFBZ0J2RSxlQUM1RixDLFFBMkVDLE8sRUEzRUEsRyxFQUFBLCtCQUVELFdBQ0VtQyxLQUFLMkMsbUJBQ1AsR0FBQyw0QkFFRCxXQUFpQixXQUVNM0MsS0FBS3VDLFdBQVdLLE9BQU0sU0FBQ0MsR0FDMUMsTUFBOEIsS0FBdkJBLEVBQWFDLEtBQ3RCLElBR0U5QyxLQUFLK0Msc0JBSVAvQyxLQUFLK0MscUJBQ0wvQyxLQUFLdUMsV0FBV1gsU0FBUSxTQUFDaUIsR0FDckIsRUFBS0csb0JBQW9CSCxFQUM3QixJQUNGLEdBQUMsK0JBRUQsV0FBb0IsV0FFbEI3QyxLQUFLdUMsV0FBV1gsU0FBUSxTQUFDaUIsR0FDdkJBLEVBQWF2QixpQkFBaUIsU0FBUyxXQUVyQyxFQUFLMEIsb0JBQW9CSCxHQUV6QixFQUFLRSxvQkFDUCxHQUNGLEdBQ0YsR0FBQyw2QkFFRCxTQUFnQkYsRUFBY0ksR0FDNUIsSUFBTUMsRUFBZWxELEtBQUtxQyxrQkFBa0I1QixjQUFjLElBQUQsT0FDbkRvQyxFQUFhTSxLQUFJLFdBRXZCTixFQUFhL0QsVUFBVWdCLElBQUlFLEtBQUtvQyxnQkFBZ0JuRSxjQUNoRGlGLEVBQWFwRSxVQUFVZ0IsSUFBSUUsS0FBS29DLGdCQUFnQmxFLGNBQ2hEZ0YsRUFBYXpCLFlBQWN3QixDQUM3QixHQUFDLDZCQUVELFNBQWdCSixHQUNkLElBQU1LLEVBQWVsRCxLQUFLcUMsa0JBQWtCNUIsY0FBYyxJQUFELE9BQ25Eb0MsRUFBYU0sS0FBSSxXQUV2Qk4sRUFBYS9ELFVBQVVPLE9BQU9XLEtBQUtvQyxnQkFBZ0JuRSxjQUNuRGlGLEVBQWFwRSxVQUFVTyxPQUFPVyxLQUFLb0MsZ0JBQWdCbEUsY0FDbkRnRixFQUFhekIsWUFBYyxFQUM3QixHQUFDLGdDQUVELFdBQ016QixLQUFLb0QsMkJBQ1BwRCxLQUFLc0Msa0JBQWtCeEQsVUFBVU8sT0FBT1csS0FBS29DLGdCQUFnQnBFLHlCQUM3RGdDLEtBQUtzQyxrQkFBa0JlLGdCQUFnQixjQUV2Q3JELEtBQUtzQyxrQkFBa0J4RCxVQUFVZ0IsSUFBSUUsS0FBS29DLGdCQUFnQnBFLHlCQUMxRGdDLEtBQUtzQyxrQkFBa0JnQixhQUFhLFlBQVksR0FFcEQsR0FBQyxpQ0FFRCxTQUFvQlQsR0FDZEEsRUFBYVUsU0FBU0MsTUFDeEJ4RCxLQUFLeUQsZ0JBQWdCWixHQUVyQjdDLEtBQUswRCxnQkFBZ0JiLEVBQWNBLEVBQWFjLGtCQUVwRCxHQUFDLHFDQUVELFdBQ0UsT0FBTzNELEtBQUt1QyxXQUFXSyxPQUFNLFNBQUNDLEdBQzVCLE9BQU9BLEVBQWFVLFNBQVNDLEtBQy9CLEdBQ0YsTSxvRUFBQyxFQWpGK0IsRyx5cUJDQWJJLEVBQUssV0FDdEIsV0FBWUMsSSw0RkFBVSxTQUNsQjdELEtBQUs4RCxVQUFZRCxFQUNqQjdELEtBQUsrRCxPQUFTdkQsU0FBU0MsY0FBY1QsS0FBSzhELFdBQzFDOUQsS0FBS2dFLGVBQWlCaEUsS0FBSytELE9BQU90RCxjQUFjLHFCQUNoRFQsS0FBS2lFLGdCQUFrQmpFLEtBQUtpRSxnQkFBZ0JDLEtBQUtsRSxLQUNyRCxDLFFBK0JDLE8sRUEvQkEsRyxFQUFBLG1CQUVELFdBQ0lBLEtBQUsrRCxPQUFPakYsVUFBVWdCLElBQUksZ0JBQzFCVSxTQUFTYyxpQkFBaUIsVUFBV3RCLEtBQUtpRSxnQkFFOUMsR0FBQyxtQkFFRCxXQUNJakUsS0FBSytELE9BQU9qRixVQUFVTyxPQUFPLGdCQUM3Qm1CLFNBQVMyRCxvQkFBb0IsVUFBV25FLEtBQUtpRSxnQkFDakQsR0FBQywrQkFFRCxXQUFvQixXQUVoQmpFLEtBQUsrRCxPQUFPekMsaUJBQWlCLGFBQWEsU0FBQzhDLEdBQ25DQSxFQUFJQyxTQUFXRCxFQUFJRSxlQUNuQixFQUFLQyxPQUViLElBRUF2RSxLQUFLZ0UsZUFBZTFDLGlCQUFpQixTQUFTLFdBQzFDLEVBQUtpRCxPQUNULEdBRUosR0FBQyw2QkFFRCxTQUFnQkgsR0FDSSxXQUFaQSxFQUFJSSxLQUNKeEUsS0FBS3VFLE9BRWIsTSxvRUFBQyxFQXJDcUIsRyw4aERDQUssSUFFVkUsRUFBYyxhLHFSQUFBLFUsUUFBQSxHLEVBQUEsRSwrWUFDL0IsV0FBWVosR0FBVSxNQUdxQyxPLDRGQUhyQyxVQUNsQixjQUFNQSxJQUNEL0MsS0FBTyxFQUFLaUQsT0FBT3RELGNBQWMsaUJBQ3RDLEVBQUtJLE1BQVEsRUFBS2tELE9BQU90RCxjQUFjLGdCQUFnQixDQUMzRCxDQU9DLE8sRUFQQSxHLEVBQUEsbUJBRUQsU0FBS2lFLEVBQVFDLEVBQVFDLEdBQ2pCNUUsS0FBS2MsS0FBS1MsSUFBTW1ELEVBQ2hCMUUsS0FBS2MsS0FBS1UsSUFBTW1ELEVBQ2hCM0UsS0FBS2EsTUFBTVksWUFBY21ELEVBQ3pCLHdDQUNKLE0sb0VBQUMsRUFaOEIsQ0FBU2hCLEcseXFCQ0Z2QmlCLEVBQU8sV0FDeEIsYUFBMEJoQixHQUFVLElBQXRCaUIsRUFBUSxFQUFSQSxVLDRGQUFRLFNBQ2xCOUUsS0FBSytFLFVBQVlELEVBQ2pCOUUsS0FBS2dGLFdBQWF4RSxTQUFTQyxjQUFjb0QsRUFDN0MsQyxRQVlDLE8sRUFaQSxHLEVBQUEsMEJBRUQsU0FBWW9CLEdBQU8sV0FDZkEsRUFBTXJELFNBQVEsU0FBQ3NELEdBQ1gsRUFBS0gsVUFBVUcsRUFDbkIsR0FDSixHQUFDLHFCQUVELFNBQVFBLEVBQU1DLEdBQ0YsUUFBUkEsRUFDTW5GLEtBQUtnRixXQUFXSSxRQUFRRixHQUN4QmxGLEtBQUtnRixXQUFXSyxPQUFPSCxFQUNqQyxNLG9FQUFDLEVBaEJ1QixHLDhoRENBRyxJQUVWSSxFQUFhLGEscVJBQUEsVSxRQUFBLEcsRUFBQSxFLCtZQUM5QixXQUFZekIsRUFBVSxHQUFrQyxNQUFoQzBCLEVBQVksRUFBWkEsYUFBY0MsRUFBYyxFQUFkQSxlQUs2QixPLDRGQUxmLFVBQ2hELGNBQU0zQixJQUNENEIsY0FBZ0JGLEVBQ3JCLEVBQUtHLGdCQUFrQkYsRUFDdkIsRUFBS0csTUFBUSxFQUFLNUIsT0FBT3RELGNBQWMsU0FDdkMsRUFBS21GLFlBQWMsRUFBS0QsTUFBTWpELGlCQUFpQixnQkFBZ0IsQ0FDbkUsQ0FpQ0MsTyxFQWpDQSxHLEVBQUEsZ0NBRUQsV0FBb0IsV0FDaEIsc0RBQ0ExQyxLQUFLMkYsTUFBTXJFLGlCQUFpQixVQUFVLFNBQUM4QyxHQUNuQ0EsRUFBSXlCLGlCQUNKekIsRUFBSTBCLDJCQUNKLEVBQUtKLGdCQUFnQixFQUFLSyxrQkFDOUIsR0FDSixHQUFDLGlDQUVELFNBQW9CQyxHQUNoQmhHLEtBQUswRixnQkFBa0JNLENBQzNCLEdBQUMsa0JBRUQsV0FDSSx5Q0FDQWhHLEtBQUt5RixlQUNULEdBQUMsbUJBRUQsV0FDSXpGLEtBQUsyRixNQUFNTSxRQUNYLHlDQUNKLEdBQUMsNkJBRUQsV0FDSSxJQUFNQyxFQUFjLENBQUMsRUFNckIsT0FMQWxHLEtBQUs0RixZQUFZaEUsU0FBUSxTQUFDdUUsR0FDdEIsSUFBTTNCLEVBQU0yQixFQUFVaEQsS0FDaEJpRCxFQUFNRCxFQUFVckQsTUFDdEJvRCxFQUFZMUIsR0FBTzRCLENBQ3ZCLElBQ09GLENBQ1gsTSxvRUFBQyxFQXhDNkIsQ0FBU3RDLEcseXFCQ0Z0QnlDLEVBQVEsV0FDekIsY0FBK0QsSUFBakRDLEVBQWMsRUFBZEEsZUFBZ0JDLEVBQWEsRUFBYkEsY0FBZUMsRUFBZSxFQUFmQSxpQiw0RkFBZSxTQUN4RHhHLEtBQUt5RyxhQUFlakcsU0FBU0MsY0FBYzZGLEdBQzNDdEcsS0FBSzBHLFlBQWNsRyxTQUFTQyxjQUFjOEYsR0FDMUN2RyxLQUFLMkcsWUFBY25HLFNBQVNDLGNBQWMrRixFQUM5QyxDLFFBZUMsTyxFQWZBLEcsRUFBQSwwQkFFRCxXQUdJLE1BQU8sQ0FBRXJELEtBRkluRCxLQUFLeUcsYUFBYWhGLFlBRWhCbUYsSUFESDVHLEtBQUswRyxZQUFZakYsWUFFakMsR0FBQyx5QkFFRCxTQUFZeUUsR0FDUmxHLEtBQUt5RyxhQUFhaEYsWUFBY3lFLEVBQVkvQyxLQUM1Q25ELEtBQUswRyxZQUFZakYsWUFBY3lFLEVBQVlVLEdBQy9DLEdBQUMsMEJBRUQsU0FBYXZJLEdBQ1QyQixLQUFLMkcsWUFBWXBGLElBQU1sRCxDQUMzQixNLG9FQUFDLEVBcEJ3QixHLHlxQkNnR2hCTyxFQUFNLElBaEdWLFdBQ04sY0FBa0MsSUFBcEJpSSxFQUFPLEVBQVBBLFFBQVNDLEVBQU8sRUFBUEEsUyw0RkFBTyxTQUUzQjlHLEtBQUsrRyxTQUFXRixFQUNoQjdHLEtBQUtnSCxTQUFXRixFQUNoQjlHLEtBQUtpSCxPQUFTSCxFQUFRSSxhQUN6QixDLFFBc0ZFLE8sRUF0RkQsRyxFQUFBLDZCQUVELFdBQ0csT0FBT0MsTUFBTSxHQUFELE9BQUluSCxLQUFLK0csU0FBUSxjQUFjLENBQ3hDRCxRQUFTOUcsS0FBS2dILFdBRWI3SCxLQUFLYSxLQUFLb0gsZUFDakIsR0FBQyw0QkFFRCxTQUFlbEIsR0FDWixPQUFPaUIsTUFBTSxHQUFELE9BQUluSCxLQUFLK0csU0FBUSxjQUFjLENBQ3hDTSxPQUFRLFFBQ1JQLFFBQVM5RyxLQUFLZ0gsU0FDZE0sS0FBTUMsS0FBS0MsVUFBVSxDQUNsQnJFLEtBQU0rQyxFQUFZL0MsS0FDbEJzRSxNQUFPdkIsRUFBWVUsUUFHckJ6SCxLQUFLYSxLQUFLb0gsZUFDakIsR0FBQyw2QkFFRCxXQUNHLE9BQU9ELE1BQU0sR0FBRCxPQUFJbkgsS0FBSytHLFNBQVEsV0FBVyxDQUNyQ0QsUUFBUzlHLEtBQUtnSCxXQUViN0gsS0FBS2EsS0FBS29ILGVBQ2pCLEdBQUMsd0JBRUQsU0FBV2xCLEdBQ1IsT0FBT2lCLE1BQU0sR0FBRCxPQUFJbkgsS0FBSytHLFNBQVEsV0FBVyxDQUNyQ00sT0FBUSxPQUNSUCxRQUFTOUcsS0FBS2dILFNBQ2RNLEtBQU1DLEtBQUtDLFVBQVUsQ0FDbEJyRSxLQUFNK0MsRUFBWXdCLE1BQ2xCQyxLQUFNekIsRUFBWTdILFFBR3BCYyxLQUFLYSxLQUFLb0gsZUFFakIsR0FBQyx3QkFFRCxTQUFXOUksR0FDUixPQUFPNkksTUFBTSxHQUFELE9BQUluSCxLQUFLK0csU0FBUSxrQkFBVXpJLEdBQU0sQ0FDMUMrSSxPQUFRLFNBQ1JQLFFBQVM5RyxLQUFLZ0gsV0FFYjdILEtBQUthLEtBQUtvSCxlQUNqQixHQUFDLHNCQUVELFNBQVM5SSxHQUNOLE9BQU82SSxNQUFNLEdBQUQsT0FBSW5ILEtBQUsrRyxTQUFRLGtCQUFVekksRUFBRSxVQUFVLENBQ2hEK0ksT0FBUSxNQUNSUCxRQUFTOUcsS0FBS2dILFdBRWI3SCxLQUFLYSxLQUFLb0gsZUFDakIsR0FBQyx3QkFFRCxTQUFXOUksR0FDUixPQUFPNkksTUFBTSxHQUFELE9BQUluSCxLQUFLK0csU0FBUSxrQkFBVXpJLEVBQUUsVUFBVSxDQUNoRCtJLE9BQVEsU0FDUlAsUUFBUzlHLEtBQUtnSCxXQUViN0gsS0FBS2EsS0FBS29ILGVBQ2pCLEdBQUMsNkJBRUQsV0FDRyxPQUFPRCxNQUFNLEdBQUQsT0FBSW5ILEtBQUsrRyxTQUFRLG9CQUFvQixDQUM5Q00sT0FBUSxNQUNSUCxRQUFTOUcsS0FBS2dILFdBRWI3SCxLQUFLYSxLQUFLb0gsZUFDakIsR0FBQyxnQ0FFRCxTQUFtQi9JLEdBQ2hCLE9BQU84SSxNQUFNLEdBQUQsT0FBSW5ILEtBQUsrRyxTQUFRLG9CQUFvQixDQUM5Q00sT0FBUSxRQUNSUCxRQUFTOUcsS0FBS2dILFNBQ2RNLEtBQU1DLEtBQUtDLFVBQVUsQ0FDbEJJLE9BQVF2SixNQUdWYyxLQUFLYSxLQUFLb0gsZUFDakIsR0FBQyw0QkFFRCxTQUFlaEksR0FDVCxPQUFPQSxFQUFJeUksR0FBS3pJLEVBQUkwSSxPQUFTQyxRQUFRQyxPQUFPNUksRUFBSTZJLE9BQ3JELE0sb0VBQUMsRUE1RkksR0FnR1UsQ0FBUSxDQUN4QnBCLFFBQVMsOENBQ1RDLFFBQVMsQ0FDTkksY0FBZSx1Q0FDZixlQUFnQixzQiwwR0N4RnRCLElBQUl6SSxFQUFTLEdBQ1B5SixFQUFhMUgsU0FBU0MsY0FBYyxzQkFDcEMwSCxFQUFnQjNILFNBQVNDLGNBQWMscUJBQ3ZDMkgsRUFBaUI1SCxTQUFTQyxjQUFjLHdCQUN4QzRILEVBQXNCN0gsU0FBU0MsY0FBYyxnQ0FDN0M2SCxFQUFzQjlILFNBQVNDLGNBQWMsb0JBQzdDOEgsRUFBcUIvSCxTQUFTQyxjQUFjLDBCQUM1QytILEVBQXNCSCxFQUFvQjVILGNBQWMsaUJBR3hEZ0ksRUFBZ0JqSSxTQUFTQyxjQUFjLHlCQUN2Q2lJLEVBQWNELEVBQWNoSSxjQUFjLGNBQzFDa0ksRUFBWUYsRUFBY2hJLGNBQWMsMkJBQ3hDbUksRUFBV0gsRUFBY2hJLGNBQWMsMEJBQ3ZDb0ksRUFBZ0JKLEVBQWNoSSxjQUFjLGlCQUc1Q3FJLEVBQWV0SSxTQUFTQyxjQUFjLHdCQUN0Q3NJLEVBQWFELEVBQWFySSxjQUFjLGFBQ3hDdUksRUFBZUYsRUFBYXJJLGNBQWMsaUJBRzFDd0ksR0FBb0IsWUFFcEJDLElBRG1CMUksU0FBU0MsY0FBY3dJLElBQ25CLElBQUkvRyxFQUFjdkUsRUFBZ0IrSyxJQUN6RFMsR0FBc0IsSUFBSWpILEVBQWN2RSxFQUFnQm9MLEdBQ3hESyxHQUE2QixJQUFJbEgsRUFBY3ZFLEVBQWdCNEssR0FFL0RjLEdBRGtCN0ksU0FBU0MsY0FBYywyQkFDSkEsY0FBYyxpQkFDckQ2SSxHQUFZLEtBQ2hCSixHQUFxQkssbUJBQ3JCSixHQUFvQkksbUJBQ3BCSCxHQUEyQkcsbUJBSTNCLElBQU1DLEdBQVcsSUFBSW5ELEVBQVMsQ0FBRUMsZUFBZ0IsaUJBQWtCQyxjQUFlLGdCQUFpQkMsZ0JBQWlCLHFCQUNuSHVCLFFBQVEwQixJQUFJLENBQUM3SyxFQUFJOEssaUJBQWtCOUssRUFBSStLLG9CQUNwQ3hLLE1BQUssWUFBaUMsSSxJQUFBLEcsRUFBQSxFLDRDQUFBLEksbzJCQUEvQnlLLEVBQVcsS0FBRUMsRUFBWSxLQUUvQkwsR0FBU00sWUFBWSxDQUFFM0csS0FBTXlHLEVBQVl6RyxLQUFNeUQsSUFBS2dELEVBQVluQyxRQUNoRStCLEdBQVNPLGFBQWFILEVBQVloQyxRQUNsQ25KLEVBQVNtTCxFQUFZMUssSUFRekIsU0FBeUIySyxJQUN2QlAsR0FBWSxJQUFJekUsRUFBUSxDQUN0QkMsU0FBVSxTQUFDa0YsR0FDVCxJQUFNeEwsRUFBUXdMLEVBQVNDLE1BQU0vSyxNQUFRVCxFQUMvQnlMLEVBQU9DLEdBQVdILEVBQVM3RyxLQUFNNkcsRUFBU3JDLEtBQU1xQyxFQUFTOUssSUFBSzhLLEVBQVN6TCxNQUFPLENBQUVDLE1BQU9BLEVBQU9DLE9BQVFBLElBQzVHNkssR0FBVWMsUUFBUUYsRUFBTSxTQUMxQixHQUVBakIsS0FFUW9CLFlBQVlSLEVBQ3hCLENBakJJUyxDQUFnQlQsRUFDbEIsSUFDQ3BLLE9BQU0sU0FBQUMsR0FDTEMsUUFBUUMsSUFBSUYsRUFDZCxJQWdCRixJQUFNNkssR0FBb0IsSUFBSWpGLEVBQzVCLHdCQUNBLENBQ0VDLGFBQWMsV0FDWixJQUFNaUYsRUFBZWhCLEdBQVNpQixjQUM5QjlCLEVBQVU3RixNQUFRMEgsRUFBYXJILEtBQy9CeUYsRUFBUzlGLE1BQVEwSCxFQUFhNUQsSUFDOUJzQyxHQUFxQndCLGdCQUN2QixFQUNBbEYsZUFBZ0IsU0FBQ1UsR0FDZjJDLEVBQWM4QixVQUFZLGdCQUMxQi9MLEVBQUlnTSxlQUFlMUUsR0FDaEIvRyxNQUFLLFdBQ0pQLEVBQUk4SyxpQkFDRHZLLE1BQUssU0FBQXlLLEdBQ0pKLEdBQVNNLFlBQVksQ0FBRTNHLEtBQU15RyxFQUFZekcsS0FBTXlELElBQUtnRCxFQUFZbkMsT0FDbEUsSUFDQ2hJLE9BQU0sU0FBQUMsR0FDTEMsUUFBUUMsSUFBSUYsRUFDZCxJQUNGNkssR0FBa0JoRyxPQUNwQixJQUNDOUUsT0FBTSxTQUFBQyxHQUNMQyxRQUFRQyxJQUFJRixFQUNkLElBQ0NtTCxTQUFRLFNBQUF6TCxHQUNQeUosRUFBYzhCLFVBQVksV0FDNUIsR0FDSixJQUdKSixHQUFrQk8sb0JBR2xCLElBQU1DLEdBQXVCLElBQUl6RixFQUMvQix1QkFDQSxDQUNFQyxhQUFjLFdBQ1o0RCxHQUFvQnVCLGdCQUN0QixFQUNBbEYsZUFBZ0IsU0FBQ1UsR0FDZjhDLEVBQWEyQixVQUFZLGdCQUN6Qi9MLEVBQUlvTSxXQUFXLENBQUV0RCxNQUFPeEIsRUFBWXdCLE1BQU9ySixJQUFLNkgsRUFBWTdILE1BQ3pEYyxNQUFLLFNBQUFDLEdBQ0osSUFBTThLLEVBQU9DLEdBQVcvSyxFQUFJK0QsS0FBTS9ELEVBQUl1SSxLQUFNdkksRUFBSUYsSUFBS0UsRUFBSWIsTUFBTyxDQUFFQyxPQUFPLEVBQU1DLE9BQVFBLElBQ3ZGNkssR0FBVWMsUUFBUUYsRUFBTSxPQUN4QmEsR0FBcUJ4RyxPQUN2QixJQUNDOUUsT0FBTSxTQUFBQyxHQUNMQyxRQUFRQyxJQUFJRixFQUNkLElBQ0NtTCxTQUFRLFNBQUF6TCxHQUNQNEosRUFBYTJCLFVBQVksV0FDM0IsR0FDSixJQUdKSSxHQUFxQkQsb0JBR3JCLElBQU1HLEdBQWlCLElBQUl4RyxFQUFlLG1CQUMxQ3dHLEdBQWVILG9CQUdmLElBQU1JLEdBQXdCLElBQUk1RixFQUFjLDBCQUM5QyxDQUNFQyxhQUFjLFdBQVEsRUFDdEJDLGVBQWdCLFdBQ2Q3RixRQUFRQyxJQUFJLGtDQUNkLElBRUpzTCxHQUFzQkosb0JBR3RCLElBQU1LLEdBQTZCLElBQUk3RixFQUFjLCtCQUNuRCxDQUNFQyxhQUFjLFdBQ1o2RCxHQUEyQnNCLGdCQUM3QixFQUNBbEYsZUFBZ0IsV0FDZGdELEVBQW9CbUMsVUFBWSxnQkFDaEMvTCxFQUFJd00sbUJBQW1COUMsRUFBb0J4RixPQUN4QzNELE1BQUssU0FBQXlLLEdBQ0pqSyxRQUFRQyxJQUFJZ0ssR0FDWkosR0FBU08sYUFBYUgsRUFBWWhDLFFBQ2xDdUQsR0FBMkI1RyxPQUM3QixJQUNDOUUsT0FBTSxTQUFBQyxHQUNMQyxRQUFRQyxJQUFJRixFQUNkLElBQ0NtTCxTQUFRLFNBQUF6TCxHQUNQb0osRUFBb0JtQyxVQUFZLFdBQ2xDLEdBQ0osSUFXRyxTQUFTUixHQUFXL0wsRUFBT0MsRUFBS0MsRUFBSUMsRUFBTyxHQUFtQixJQUFqQkMsRUFBSyxFQUFMQSxNQUFPQyxFQUFNLEVBQU5BLE9BQ25EeUwsRUFBTyxJQUFJL0wsRUFDZkMsRUFDQUMsRUFDQUMsRUFDQUMsRUFDQSxDQUNFQyxNQUFBQSxFQUNBQyxPQUFBQSxHQUVGLENBQ0VDLGlCQUFrQixTQUFDZ0csRUFBUUMsRUFBUUMsR0FDakNxRyxHQUFlSSxLQUFLM0csRUFBUUMsRUFBUUMsRUFDdEMsRUFDQWpHLG9CQUFxQixTQUFDTCxHQUNwQjRNLEdBQXNCRyxPQUN0QkgsR0FBc0JJLHFCQUFvQixXQUN4Q2pDLEdBQW1Cc0IsVUFBWSxjQUMvQi9MLEVBQUkyTSxXQUFXak4sR0FDWmEsTUFBSyxXQUNKK0ssRUFBS3FCLGFBQ0xMLEdBQXNCM0csT0FDeEIsSUFDQzlFLE9BQU0sU0FBQUMsR0FDTEMsUUFBUUMsSUFBSUYsRUFDZCxJQUNDbUwsU0FBUSxXQUNQeEIsR0FBbUJzQixVQUFZLFdBQ2pDLEdBQ0osR0FFRixHQUVGLENBQ0UvTCxJQUFLQSxJQUdULE9BQU9zTCxFQUFLc0IsU0FDZCxDQS9DQUwsR0FBMkJMLG9CQUkzQjVDLEVBQVc1RyxpQkFBaUIsU0FBUyxXQUFRaUosR0FBa0JjLE1BQU8sSUFDdEVsRCxFQUFjN0csaUJBQWlCLFNBQVMsV0FBUXlKLEdBQXFCTSxNQUFPLElBQzVFakQsRUFBZTlHLGlCQUFpQixTQUFTLFdBQVE2SixHQUEyQkUsTUFBTyxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9wYWdlcy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBEZWZhdWx0IGRhdGFcbmNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIG5hbWU6ICfQkNGA0YXRi9C3JyxcbiAgICBsaW5rOiAnaHR0cHM6Ly9waWN0dXJlcy5zMy55YW5kZXgubmV0L2Zyb250ZW5kLWRldmVsb3Blci9jYXJkcy1jb21wcmVzc2VkL2Fya2h5ei5qcGcnLFxuICB9LFxuICB7XG4gICAgbmFtZTogJ9Cn0LXQu9GP0LHQuNC90YHQutCw0Y8g0L7QsdC70LDRgdGC0YwnLFxuICAgIGxpbms6ICdodHRwczovL3BpY3R1cmVzLnMzLnlhbmRleC5uZXQvZnJvbnRlbmQtZGV2ZWxvcGVyL2NhcmRzLWNvbXByZXNzZWQvY2hlbHlhYmluc2stb2JsYXN0LmpwZycsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiAn0JjQstCw0L3QvtCy0L4nLFxuICAgIGxpbms6ICdodHRwczovL3BpY3R1cmVzLnMzLnlhbmRleC5uZXQvZnJvbnRlbmQtZGV2ZWxvcGVyL2NhcmRzLWNvbXByZXNzZWQvaXZhbm92by5qcGcnLFxuICB9LFxuICB7XG4gICAgbmFtZTogJ9Ca0LDQvNGH0LDRgtC60LAnLFxuICAgIGxpbms6ICdodHRwczovL3BpY3R1cmVzLnMzLnlhbmRleC5uZXQvZnJvbnRlbmQtZGV2ZWxvcGVyL2NhcmRzLWNvbXByZXNzZWQva2FtY2hhdGthLmpwZycsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiAn0KXQvtC70LzQvtCz0L7RgNGB0LrQuNC5INGA0LDQudC+0L0nLFxuICAgIGxpbms6ICdodHRwczovL3BpY3R1cmVzLnMzLnlhbmRleC5uZXQvZnJvbnRlbmQtZGV2ZWxvcGVyL2NhcmRzLWNvbXByZXNzZWQva2hvbG1vZ29yc2t5LXJheW9uLmpwZycsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiAn0JHQsNC50LrQsNC7JyxcbiAgICBsaW5rOiAnaHR0cHM6Ly9waWN0dXJlcy5zMy55YW5kZXgubmV0L2Zyb250ZW5kLWRldmVsb3Blci9jYXJkcy1jb21wcmVzc2VkL2JhaWthbC5qcGcnLFxuICB9LFxuXTtcbmNvbnN0IHZhbGlkYXRpb25EYXRhID0ge1xuICBmb3JtU2VsZWN0b3I6ICcuZm9ybScsXG4gIGlucHV0U2VsZWN0b3I6ICcuZm9ybV9faW5wdXQnLFxuICBzdWJtaXR0aW5nQnV0dG9uU2VsZWN0b3I6ICcuZm9ybV9fc3VibWl0JyxcbiAgaW5wdXRFcnJvclNlbGVjdG9yOiAnLmVycm9yJyxcbiAgc3VibWl0dGluZ0J1dHRvbkludmFsaWQ6ICdmb3JtX19zdWJtaXRfaW52YWxpZCcsXG4gIGlucHV0SW52YWxpZDogJ2Zvcm1fX2lucHV0X2ludmFsaWQnLFxuICBlcnJvclZpc2libGU6ICdlcnJvcl92aXNpYmxlJ1xufTtcblxuXG5leHBvcnQge2luaXRpYWxDYXJkcywgdmFsaWRhdGlvbkRhdGF9OyIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3Rvcih0aXRsZSwgdXJsLCBpZCwgbGlrZXMsIHsgb3duZWQsIHVzZXJJZCB9LCB7IGhhbmRsZUltYWdlQ2xpY2ssIGhhbmRsZURlbGV0aW9uQ2xpY2sgfSwgeyBhcGkgfSkge1xuICAgIHRoaXMuX3RpdGxlID0gdGl0bGU7XG4gICAgdGhpcy5fdXJsID0gdXJsO1xuICAgIHRoaXMuX2lkID0gaWQ7XG4gICAgdGhpcy5fbGlrZXMgPSBsaWtlcztcbiAgICB0aGlzLl9saWtlc0NvdW50ID0gbGlrZXMubGVuZ3RoO1xuICAgIHRoaXMuX293bmVkID0gb3duZWQ7XG4gICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xuICAgIHRoaXMuX2FwaSA9IGFwaTtcblxuICAgIHRoaXMuX3RlbXBsYXRlU2VsZWN0b3IgPSAnLnRlbXBsYXRlJztcbiAgICB0aGlzLl90ZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fdGVtcGxhdGVTZWxlY3RvcikuY29udGVudDtcbiAgICB0aGlzLl9jYXJkID0gdGhpcy5fdGVtcGxhdGUucXVlcnlTZWxlY3RvcignLmVsZW1lbnQnKS5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgdGhpcy5fdGV4dCA9IHRoaXMuX2NhcmQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX3RpdGxlJyk7XG4gICAgdGhpcy5faW1nID0gdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9faW1hZ2UnKTtcbiAgICB0aGlzLl9yZW1vdmVCdG4gPSB0aGlzLl9jYXJkLnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X19yZW1vdmUnKTtcbiAgICB0aGlzLl9saWtlQnRuID0gdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9fbGlrZScpO1xuICAgIHRoaXMuX2xpa2VDb3VudCA9IHRoaXMuX2NhcmQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX2xpa2UtY291bnQnKTtcblxuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0aW9uQ2xpY2sgPSBoYW5kbGVEZWxldGlvbkNsaWNrO1xuICB9XG5cbiAgX2NyZWF0ZUNhcmQoKSB7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9pbnNlcnREYXRhKCk7XG4gICAgdGhpcy5fc2V0TGlrZUNvdW50KCk7XG4gICAgdGhpcy5fdG9nZ2xlRGVsZXRlQnRuSWZPd25lZCgpO1xuICAgIHRoaXMuX2NoZWNrSWZMaWtlZCgpO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2ltZy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2soXG4gICAgICAgIHRoaXMuX2ltZy5zcmMsXG4gICAgICAgIHRoaXMuX2ltZy5hbHQsXG4gICAgICAgIHRoaXMuX3RleHQudGV4dENvbnRlbnRcbiAgICAgICk7XG4gICAgfSk7XG4gICAgdGhpcy5fbGlrZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX3RvZ2dsZUxpa2UpO1xuICAgIHRoaXMuX3JlbW92ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX2NsaWNrUmVtb3ZlKTtcbiAgfVxuXG4gIF9jaGVja0lmTGlrZWQoKSB7XG4gICAgdGhpcy5fbGlrZXMuZm9yRWFjaCgobGlrZSkgPT4ge1xuICAgICAgaWYgKGxpa2UuX2lkID09PSB0aGlzLl91c2VySWQpIHtcbiAgICAgICAgdGhpcy5fYmxhY2tlbkxpa2UoKVxuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICBfYmxhY2tlbkxpa2UoKSB7XG4gICAgdGhpcy5fbGlrZUJ0bi5jbGFzc0xpc3QuYWRkKCdlbGVtZW50X19saWtlX2FjdGl2ZScpO1xuICB9XG5cbiAgX3RvZ2dsZUxpa2UgPSAoKSA9PiB7XG4gICAgaWYgKHRoaXMuX2xpa2VCdG4uY2xhc3NMaXN0LmNvbnRhaW5zKCdlbGVtZW50X19saWtlX2FjdGl2ZScpKSB7XG4gICAgICB0aGlzLl9hcGkudW5saWtlQ2FyZCh0aGlzLl9pZClcbiAgICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgICB0aGlzLl9saWtlQnRuLmNsYXNzTGlzdC5yZW1vdmUoJ2VsZW1lbnRfX2xpa2VfYWN0aXZlJyk7XG4gICAgICAgICAgdGhpcy5fbGlrZXNDb3VudCA9IHJlcy5saWtlcy5sZW5ndGg7XG4gICAgICAgICAgdGhpcy5fc2V0TGlrZUNvdW50KCk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaChlcnIgPT4ge1xuICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9hcGkubGlrZUNhcmQodGhpcy5faWQpXG4gICAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgdGhpcy5fbGlrZUJ0bi5jbGFzc0xpc3QuYWRkKCdlbGVtZW50X19saWtlX2FjdGl2ZScpO1xuICAgICAgICAgIHRoaXMuX2xpa2VzQ291bnQgPSByZXMubGlrZXMubGVuZ3RoO1xuICAgICAgICAgIHRoaXMuX3NldExpa2VDb3VudCgpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goZXJyID0+IHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBfc2V0TGlrZUNvdW50KCkge1xuICAgIGlmICh0aGlzLl9saWtlc0NvdW50ID4gMCkge1xuICAgICAgdGhpcy5fbGlrZUNvdW50LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgdGhpcy5fbGlrZUNvdW50LnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXNDb3VudDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fbGlrZUNvdW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgfVxuICB9XG5cbiAgX3RvZ2dsZURlbGV0ZUJ0bklmT3duZWQoKSB7XG4gICAgdGhpcy5fb3duZWRcbiAgICAgID8gdGhpcy5fcmVtb3ZlQnRuLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snXG4gICAgICA6IHRoaXMuX3JlbW92ZUJ0bi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnXG4gIH1cblxuICBfY2xpY2tSZW1vdmUgPSAoKSA9PiB7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRpb25DbGljayh0aGlzLl9pZCk7XG4gIH1cblxuICBkZWxldGVDYXJkKCkge1xuICAgIHRoaXMuX2NhcmQucmVtb3ZlKCk7XG4gICAgdGhpcy5fdGVtcGxhdGUgPSBudWxsO1xuICAgIHRoaXMuX2NhcmQgPSBudWxsO1xuICB9XG5cbiAgX2luc2VydERhdGEoKSB7XG4gICAgdGhpcy5faW1nLnNyYyA9IHRoaXMuX3VybDtcbiAgICB0aGlzLl9pbWcuYWx0ID0gdGhpcy5fdGl0bGU7XG4gICAgdGhpcy5fdGV4dC50ZXh0Q29udGVudCA9IHRoaXMuX3RpdGxlO1xuICB9XG5cbiAgZ2V0Q2FyZCgpIHtcbiAgICB0aGlzLl9jcmVhdGVDYXJkKCk7XG4gICAgcmV0dXJuIHRoaXMuX2NhcmQ7XG4gIH1cbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3IgKHZhbGlkYXRpb25EYXRhLCB2YWxpZGF0aW9uT2JqZWN0KSB7XG4gICAgdGhpcy5fdmFsaWRhdGlvbkRhdGEgPSB2YWxpZGF0aW9uRGF0YTtcbiAgICB0aGlzLl92YWxpZGF0aW9uT2JqZWN0ID0gdmFsaWRhdGlvbk9iamVjdDtcbiAgICB0aGlzLl9zdWJtaXR0aW5nQnV0dG9uID0gdGhpcy5fdmFsaWRhdGlvbk9iamVjdC5xdWVyeVNlbGVjdG9yKHRoaXMuX3ZhbGlkYXRpb25EYXRhLnN1Ym1pdHRpbmdCdXR0b25TZWxlY3Rvcik7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbSh0aGlzLl92YWxpZGF0aW9uT2JqZWN0LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fdmFsaWRhdGlvbkRhdGEuaW5wdXRTZWxlY3RvcikpO1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVyKCk7XG4gIH1cbiAgXG4gIHZhbGlkYXRlT25PcGVuKCkge1xuICAgIC8vIElmIG5vIGlucHV0IGlzIG1hZGUsIHNob3cgbm8gZXJyb3JcbiAgICBjb25zdCBpbnB1dElzRW1wdHkgPSB0aGlzLl9pbnB1dExpc3QuZXZlcnkoKGlucHV0RWxlbWVudCkgPT4geyBcbiAgICAgIHJldHVybiBpbnB1dEVsZW1lbnQudmFsdWUgPT09ICcnOyBcbiAgICB9KTtcbiAgICBcbiAgICBpZiAoaW5wdXRJc0VtcHR5KSB7IFxuICAgICAgdGhpcy5fdG9nZ2xlU3VibWl0U3RhdGUoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLl90b2dnbGVTdWJtaXRTdGF0ZSgpO1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XG4gICAgfSlcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVyKCkge1xuICAgIC8vIFF1ZXJ5aW5nIGV2ZXJ5IC5mb3JtX19pbnB1dFxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcbiAgICAgICAgLy8gSGFuZGxpbmcgRXJyb3IgbWVzc2FnZSAoc3BhbikgJiBSZWQgdW5kZXJsaW5lIHdhcm5pbmdcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XG4gICAgICAgIC8vIEhhbmRsaW5nIFN1Ym1pdCBCdXR0b24gc3RhdGU6XG4gICAgICAgIHRoaXMuX3RvZ2dsZVN1Ym1pdFN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSkge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX3ZhbGlkYXRpb25PYmplY3QucXVlcnlTZWxlY3RvcihcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQubmFtZX0tZXJyb3JgXG4gICAgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl92YWxpZGF0aW9uRGF0YS5pbnB1dEludmFsaWQpO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX3ZhbGlkYXRpb25EYXRhLmVycm9yVmlzaWJsZSk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xuICB9XG5cbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX3ZhbGlkYXRpb25PYmplY3QucXVlcnlTZWxlY3RvcihcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQubmFtZX0tZXJyb3JgXG4gICAgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl92YWxpZGF0aW9uRGF0YS5pbnB1dEludmFsaWQpO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3ZhbGlkYXRpb25EYXRhLmVycm9yVmlzaWJsZSk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gJyc7XG4gIH1cblxuICBfdG9nZ2xlU3VibWl0U3RhdGUoKSB7XG4gICAgaWYgKHRoaXMuX2NoZWNrSWZBbGxJbnB1dElzVmFsaWQoKSkge1xuICAgICAgdGhpcy5fc3VibWl0dGluZ0J1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3ZhbGlkYXRpb25EYXRhLnN1Ym1pdHRpbmdCdXR0b25JbnZhbGlkKTtcbiAgICAgIHRoaXMuX3N1Ym1pdHRpbmdCdXR0b24ucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zdWJtaXR0aW5nQnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5fdmFsaWRhdGlvbkRhdGEuc3VibWl0dGluZ0J1dHRvbkludmFsaWQpO1xuICAgICAgdGhpcy5fc3VibWl0dGluZ0J1dHRvbi5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgdHJ1ZSk7XG4gICAgfVxuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcbiAgICBpZiAoaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XG4gICAgfVxuICB9XG5cbiAgX2NoZWNrSWZBbGxJbnB1dElzVmFsaWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5ldmVyeSgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICByZXR1cm4gaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xuICAgIH0pO1xuICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHNlbGVjdG9yKSB7XG4gICAgICAgIHRoaXMuX3NlbGVjdG9yID0gc2VsZWN0b3I7XG4gICAgICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9zZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuX3BvcHVwQ2xvc2VCdG4gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Nsb3NlLWJ0bicpO1xuICAgICAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7IFxuICAgIH1cblxuICAgIG9wZW4oKSB7XG4gICAgICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoJ3BvcHVwX29wZW5lZCcpO1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuXG4gICAgfVxuXG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ3BvcHVwX29wZW5lZCcpO1xuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgIH1cblxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgICAvLyBDbG9zaW5nIGJ5IGNsaWNrIG9uIE92ZXJsYXlcbiAgICAgICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgKGV2dCkgPT4ge1xuICAgICAgICAgICAgaWYgKGV2dC50YXJnZXQgPT09IGV2dC5jdXJyZW50VGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgLy8gQ2xvc2luZyBieSBjbGljayBvbiBDbG9zZSBCdXR0b25cbiAgICAgICAgdGhpcy5fcG9wdXBDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSk7XG5cbiAgICB9XG5cbiAgICBfaGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XG4gICAgICAgIGlmIChldnQua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG59IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHNlbGVjdG9yKSB7XG4gICAgICAgIHN1cGVyKHNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5faW1nID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbWFnZScpO1xuICAgICAgICB0aGlzLl90ZXh0ID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX190ZXh0Jyk7XG4gICAgfVxuXG4gICAgb3BlbihpbWdTcmMsIGltZ0FsdCwgdGV4dCkge1xuICAgICAgICB0aGlzLl9pbWcuc3JjID0gaW1nU3JjO1xuICAgICAgICB0aGlzLl9pbWcuYWx0ID0gaW1nQWx0O1xuICAgICAgICB0aGlzLl90ZXh0LnRleHRDb250ZW50ID0gdGV4dDtcbiAgICAgICAgc3VwZXIub3BlbigpO1xuICAgIH1cbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgICBjb25zdHJ1Y3Rvcih7IHJlbmRlcmVyIH0sIHNlbGVjdG9yKSB7XG4gICAgICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xuICAgIH1cblxuICAgIHJlbmRlckl0ZW1zKGl0ZW1zKSB7XG4gICAgICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBhZGRJdGVtKGl0ZW0sIHBvcykge1xuICAgICAgICBwb3MgPT09ICd0b3AnXG4gICAgICAgICAgICA/IHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGl0ZW0pXG4gICAgICAgICAgICA6IHRoaXMuX2NvbnRhaW5lci5hcHBlbmQoaXRlbSk7XG4gICAgfVxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHNlbGVjdG9yLCB7IG9wZW5DYWxsYmFjaywgc3VibWl0Q2FsbGJhY2sgfSkge1xuICAgICAgICBzdXBlcihzZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuX29wZW5DYWxsYmFjayA9IG9wZW5DYWxsYmFjaztcbiAgICAgICAgdGhpcy5fc3VibWl0Q2FsbGJhY2sgPSBzdWJtaXRDYWxsYmFjaztcbiAgICAgICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5mb3JtJyk7XG4gICAgICAgIHRoaXMuX2Zvcm1JbnB1dHMgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoJy5mb3JtX19pbnB1dCcpO1xuICAgIH1cblxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgICAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHtcbiAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgZXZ0LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgdGhpcy5fc3VibWl0Q2FsbGJhY2sodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGNoYW5nZVN1bWJpdEhhbmRsZXIobmV3U3VibWl0SGFuZGVsZXIpIHtcbiAgICAgICAgdGhpcy5fc3VibWl0Q2FsbGJhY2sgPSBuZXdTdWJtaXRIYW5kZWxlcjtcbiAgICB9XG5cbiAgICBvcGVuKCkge1xuICAgICAgICBzdXBlci5vcGVuKCk7XG4gICAgICAgIHRoaXMuX29wZW5DYWxsYmFjaygpO1xuICAgIH1cblxuICAgIGNsb3NlKCkge1xuICAgICAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XG4gICAgICAgIHN1cGVyLmNsb3NlKCk7XG4gICAgfVxuXG4gICAgX2dldElucHV0VmFsdWVzKCkge1xuICAgICAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9O1xuICAgICAgICB0aGlzLl9mb3JtSW5wdXRzLmZvckVhY2goKGZvcm1JbnB1dCkgPT4ge1xuICAgICAgICAgICAgY29uc3Qga2V5ID0gZm9ybUlucHV0Lm5hbWU7XG4gICAgICAgICAgICBjb25zdCB2YWwgPSBmb3JtSW5wdXQudmFsdWU7XG4gICAgICAgICAgICBpbnB1dFZhbHVlc1trZXldID0gdmFsO1xuICAgICAgICB9KVxuICAgICAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XG4gICAgfVxuXG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICAgIGNvbnN0cnVjdG9yKHsgcHJvZmlsZU5hbWVTZWwsIHByb2ZpbGVKb2JTZWwsIHByb2ZpbGVJbWFnZVNlbH0pIHtcbiAgICAgICAgdGhpcy5fcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHByb2ZpbGVOYW1lU2VsKTtcbiAgICAgICAgdGhpcy5fcHJvZmlsZUpvYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocHJvZmlsZUpvYlNlbCk7XG4gICAgICAgIHRoaXMuX3Byb2ZpbGVJbWcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHByb2ZpbGVJbWFnZVNlbCk7XG4gICAgfVxuXG4gICAgZ2V0VXNlckluZm8oKSB7XG4gICAgICAgIGNvbnN0IG5hbWUgPSB0aGlzLl9wcm9maWxlTmFtZS50ZXh0Q29udGVudDtcbiAgICAgICAgY29uc3Qgam9iID0gdGhpcy5fcHJvZmlsZUpvYi50ZXh0Q29udGVudDtcbiAgICAgICAgcmV0dXJuIHsgbmFtZSwgam9iIH07XG4gICAgfVxuXG4gICAgc2V0VXNlckluZm8oaW5wdXRWYWx1ZXMpIHtcbiAgICAgICAgdGhpcy5fcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBpbnB1dFZhbHVlcy5uYW1lO1xuICAgICAgICB0aGlzLl9wcm9maWxlSm9iLnRleHRDb250ZW50ID0gaW5wdXRWYWx1ZXMuam9iO1xuICAgIH1cblxuICAgIHNldFVzZXJJbWFnZSh1cmwpIHtcbiAgICAgICAgdGhpcy5fcHJvZmlsZUltZy5zcmMgPSB1cmw7XG4gICAgfVxuXG59IiwiY2xhc3MgQXBpIHtcbiAgIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XG4gICAgICAvLyDRgtC10LvQviDQutC+0L3RgdGC0YDRg9C60YLQvtGA0LBcbiAgICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xuICAgICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XG4gICAgICB0aGlzLl90b2tlbiA9IGhlYWRlcnMuYXV0aG9yaXphdGlvbjtcbiAgIH1cblxuICAgZ2V0UHJvZmlsZURhdGEoKSB7XG4gICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYCwge1xuICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIH0pXG4gICAgICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgIH1cblxuICAgc2V0UHJvZmlsZURhdGEoaW5wdXRWYWx1ZXMpIHtcbiAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9gLCB7XG4gICAgICAgICBtZXRob2Q6ICdQQVRDSCcsXG4gICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgbmFtZTogaW5wdXRWYWx1ZXMubmFtZSxcbiAgICAgICAgICAgIGFib3V0OiBpbnB1dFZhbHVlcy5qb2JcbiAgICAgICAgIH0pXG4gICAgICB9KVxuICAgICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gICB9XG5cbiAgIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9gLCB7XG4gICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgfSlcbiAgICAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICAgfVxuXG4gICBhZGROZXdDYXJkKGlucHV0VmFsdWVzKSB7XG4gICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvYCwge1xuICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgbmFtZTogaW5wdXRWYWx1ZXMucGxhY2UsXG4gICAgICAgICAgICBsaW5rOiBpbnB1dFZhbHVlcy51cmxcbiAgICAgICAgIH0pXG4gICAgICB9KVxuICAgICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG5cbiAgIH1cblxuICAgZGVsZXRlQ2FyZChpZCkge1xuICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9YCwge1xuICAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICB9KVxuICAgICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gICB9XG5cbiAgIGxpa2VDYXJkKGlkKSB7XG4gICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH0vbGlrZXNgLCB7XG4gICAgICAgICBtZXRob2Q6ICdQVVQnLFxuICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIH0pXG4gICAgICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgIH1cblxuICAgdW5saWtlQ2FyZChpZCkge1xuICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9L2xpa2VzYCwge1xuICAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICB9KVxuICAgICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gICB9XG5cbiAgIGdldFByb2ZpbGVJbWFnZSgpIHtcbiAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIH0pXG4gICAgICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgIH1cblxuICAgdXBkYXRlUHJvZmlsZUltYWdlKHVybCkge1xuICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgICAgIG1ldGhvZDogJ1BBVENIJyxcbiAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBhdmF0YXI6IHVybCxcbiAgICAgICAgIH0pXG4gICAgICB9KVxuICAgICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gICB9XG5cbiAgIF9jaGVja1Jlc3BvbnNlKHJlcykge1xuICAgICAgICAgcmV0dXJuIHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdChyZXMuc3RhdHVzKTtcbiAgICB9XG5cbn1cblxuZXhwb3J0IGNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICAgYmFzZVVybDogJ2h0dHBzOi8vbWVzdG8ubm9tb3JlcGFydGllcy5jby92MS9jb2hvcnQtNTUnLFxuICAgaGVhZGVyczoge1xuICAgICAgYXV0aG9yaXphdGlvbjogJ2ExMTBmNDA2LTY1NGYtNGM1My1iYWU2LTNiODkwNWI0OWI0MycsXG4gICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICB9LFxufSk7IiwiLy8gSW1wb3J0c1xuaW1wb3J0ICcuL2luZGV4LmNzcyc7XG5pbXBvcnQgeyB2YWxpZGF0aW9uRGF0YSB9IGZyb20gJy4uL3V0aWxzL2NvbnN0YW50cy5qcyc7XG5pbXBvcnQgQ2FyZCBmcm9tICcuLi9jb21wb25lbnRzL0NhcmQuanMnO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tICcuLi9jb21wb25lbnRzL1NlY3Rpb24uanMnO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSAnLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzJztcbmltcG9ydCBVc2VySW5mbyBmcm9tICcuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzJztcbmltcG9ydCB7IGFwaSB9IGZyb20gJy4uL2NvbXBvbmVudHMvQXBpLmpzJztcblxuLy8gUHJvZmlsZSBlbGVtZW50c1xubGV0IHVzZXJJZCA9ICcnXG5jb25zdCBlZGl0aW5nQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2VkaXQtYnRuJyk7XG5jb25zdCBhZGRpbmdDYXJkQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2FkZC1idG4nKTtcbmNvbnN0IGVkaXRQcm9maWxlSW1nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2F2YXRhci1ib3gnKTtcbmNvbnN0IHBvcHVwRWRpdFByb2ZpbGVJbWcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9lZGl0LXByb2ZpbGUtaW1nJyk7XG5jb25zdCBmb3JtSW5wdXRQcm9maWxlSW1nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZvcm1fX2lucHV0X2ltZycpO1xuY29uc3QgZWRpdFByb2ZpbGVJbWdGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZvcm0tZWRpdC1wcm9maWxlLWltZycpO1xuY29uc3Qgc3VibWl0UHJvZmlsZUltZ0J0biA9IHBvcHVwRWRpdFByb2ZpbGVJbWcucXVlcnlTZWxlY3RvcignLmZvcm1fX3N1Ym1pdCcpO1xuXG4vLyBQb3B1cCBlZGl0LWNhcmQgZWxlbWVudHNcbmNvbnN0IHBvcHVwRWRpdENhcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9lZGl0LWNhcmQnKTtcbmNvbnN0IGVkaXRpbmdGb3JtID0gcG9wdXBFZGl0Q2FyZC5xdWVyeVNlbGVjdG9yKCcuZm9ybS1lZGl0Jyk7XG5jb25zdCBpbnB1dE5hbWUgPSBwb3B1cEVkaXRDYXJkLnF1ZXJ5U2VsZWN0b3IoJy5mb3JtX19pbnB1dF9maWVsZC1uYW1lJyk7XG5jb25zdCBpbnB1dEpvYiA9IHBvcHVwRWRpdENhcmQucXVlcnlTZWxlY3RvcignLmZvcm1fX2lucHV0X2ZpZWxkLWpvYicpO1xuY29uc3Qgc3VibWl0RWRpdEJ0biA9IHBvcHVwRWRpdENhcmQucXVlcnlTZWxlY3RvcignLmZvcm1fX3N1Ym1pdCcpO1xuXG4vLyBQb3B1cCBhZGQtY2FyZCBlbGVtZW50c1xuY29uc3QgcG9wdXBBZGRDYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfYWRkLWNhcmQnKTtcbmNvbnN0IGFkZGluZ0Zvcm0gPSBwb3B1cEFkZENhcmQucXVlcnlTZWxlY3RvcignLmZvcm0tYWRkJyk7XG5jb25zdCBzdWJtaXRBZGRCdG4gPSBwb3B1cEFkZENhcmQucXVlcnlTZWxlY3RvcignLmZvcm1fX3N1Ym1pdCcpO1xuXG4vLyBPdGhlciBkYXRhXG5jb25zdCBjYXJkc0NvbnRhaW5lclNlbCA9ICcuZWxlbWVudHMnO1xuY29uc3QgY2FyZHNDb250YWluZXJFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY2FyZHNDb250YWluZXJTZWwpO1xuY29uc3QgZWRpdGluZ0Zvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uRGF0YSwgZWRpdGluZ0Zvcm0pO1xuY29uc3QgYWRkaW5nRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25EYXRhLCBhZGRpbmdGb3JtKTtcbmNvbnN0IHVwZGF0aW5nSW1hZ2VGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvbkRhdGEsIGVkaXRQcm9maWxlSW1nRm9ybSk7XG5jb25zdCBwb3B1cERlbGV0ZUNhcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9kZWxldGUtY2FyZCcpO1xuY29uc3Qgc3VibWl0Q2FyZERlbGV0aW9uID0gcG9wdXBEZWxldGVDYXJkLnF1ZXJ5U2VsZWN0b3IoJy5mb3JtX19zdWJtaXQnKTtcbmxldCBjYXJkc0xpc3QgPSBudWxsO1xuZWRpdGluZ0Zvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuYWRkaW5nRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG51cGRhdGluZ0ltYWdlRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbi8vIFNldHRpbmcgVXNlciBJbmZvXG4vLyBTZXR0aW5nIGluaXRpYWwgQ2FyZHMgZnJvbSBBUElcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHsgcHJvZmlsZU5hbWVTZWw6ICcucHJvZmlsZV9fbmFtZScsIHByb2ZpbGVKb2JTZWw6ICcucHJvZmlsZV9fam9iJywgcHJvZmlsZUltYWdlU2VsOiAnLnByb2ZpbGVfX2F2YXRhcicgfSk7XG5Qcm9taXNlLmFsbChbYXBpLmdldFByb2ZpbGVEYXRhKCksIGFwaS5nZXRJbml0aWFsQ2FyZHMoKV0pXG4gIC50aGVuKChbcHJvZmlsZURhdGEsIGluaXRpYWxDYXJkc10pID0+IHtcbiAgICAvLyBGZXRjaGVkIHByb2ZpbGUgZGF0YVxuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHsgbmFtZTogcHJvZmlsZURhdGEubmFtZSwgam9iOiBwcm9maWxlRGF0YS5hYm91dCB9KVxuICAgIHVzZXJJbmZvLnNldFVzZXJJbWFnZShwcm9maWxlRGF0YS5hdmF0YXIpO1xuICAgIHVzZXJJZCA9IHByb2ZpbGVEYXRhLl9pZDtcbiAgICAvLyBGZXRjaGVkIGNhcmRzIGRhdGFcbiAgICBzZXRJbml0aWFsQ2FyZHMoaW5pdGlhbENhcmRzKTtcbiAgfSlcbiAgLmNhdGNoKGVyciA9PiB7XG4gICAgY29uc29sZS5sb2coZXJyKTtcbiAgfSk7XG5cbmZ1bmN0aW9uIHNldEluaXRpYWxDYXJkcyhpbml0aWFsQ2FyZHMpIHtcbiAgY2FyZHNMaXN0ID0gbmV3IFNlY3Rpb24oe1xuICAgIHJlbmRlcmVyOiAoY2FyZEl0ZW0pID0+IHtcbiAgICAgIGNvbnN0IG93bmVkID0gY2FyZEl0ZW0ub3duZXIuX2lkID09PSB1c2VySWQ7XG4gICAgICBjb25zdCBjYXJkID0gY3JlYXRlQ2FyZChjYXJkSXRlbS5uYW1lLCBjYXJkSXRlbS5saW5rLCBjYXJkSXRlbS5faWQsIGNhcmRJdGVtLmxpa2VzLCB7IG93bmVkOiBvd25lZCwgdXNlcklkOiB1c2VySWQgfSk7XG4gICAgICBjYXJkc0xpc3QuYWRkSXRlbShjYXJkLCAnYm90dG9tJyk7XG4gICAgfSxcbiAgfSxcbiAgICBjYXJkc0NvbnRhaW5lclNlbFxuICApXG4gIGNhcmRzTGlzdC5yZW5kZXJJdGVtcyhpbml0aWFsQ2FyZHMpO1xufVxuXG4vLyBQb3B1cCBFZGl0IFVzZXIgSW5mbyBoYW5kbGluZ1xuY29uc3QgcG9wdXBXaXRoRWRpdEZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgJy5wb3B1cF90eXBlX2VkaXQtY2FyZCcsXG4gIHtcbiAgICBvcGVuQ2FsbGJhY2s6ICgpID0+IHtcbiAgICAgIGNvbnN0IHVzZXJJbmZvRGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gICAgICBpbnB1dE5hbWUudmFsdWUgPSB1c2VySW5mb0RhdGEubmFtZTtcbiAgICAgIGlucHV0Sm9iLnZhbHVlID0gdXNlckluZm9EYXRhLmpvYjtcbiAgICAgIGVkaXRpbmdGb3JtVmFsaWRhdG9yLnZhbGlkYXRlT25PcGVuKCk7XG4gICAgfSxcbiAgICBzdWJtaXRDYWxsYmFjazogKGlucHV0VmFsdWVzKSA9PiB7XG4gICAgICBzdWJtaXRFZGl0QnRuLmlubmVyVGV4dCA9ICfQodC+0YXRgNCw0L3QtdC90LjQtS4uLic7XG4gICAgICBhcGkuc2V0UHJvZmlsZURhdGEoaW5wdXRWYWx1ZXMpXG4gICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICBhcGkuZ2V0UHJvZmlsZURhdGEoKVxuICAgICAgICAgICAgLnRoZW4ocHJvZmlsZURhdGEgPT4ge1xuICAgICAgICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7IG5hbWU6IHByb2ZpbGVEYXRhLm5hbWUsIGpvYjogcHJvZmlsZURhdGEuYWJvdXQgfSlcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goZXJyID0+IHtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgcG9wdXBXaXRoRWRpdEZvcm0uY2xvc2UoKVxuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goZXJyID0+IHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICB9KVxuICAgICAgICAuZmluYWxseShyZXMgPT4ge1xuICAgICAgICAgIHN1Ym1pdEVkaXRCdG4uaW5uZXJUZXh0ID0gJ9Ch0L7RhdGA0LDQvdC40YLRjCc7XG4gICAgICAgIH0pXG4gICAgfVxuICB9XG4pXG5wb3B1cFdpdGhFZGl0Rm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBQb3B1cCBBZGQtQ2FyZCBoYW5kbGluZ1xuY29uc3QgcG9wdXBXaXRoQWRkQ2FyZEZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgJy5wb3B1cF90eXBlX2FkZC1jYXJkJyxcbiAge1xuICAgIG9wZW5DYWxsYmFjazogKCkgPT4ge1xuICAgICAgYWRkaW5nRm9ybVZhbGlkYXRvci52YWxpZGF0ZU9uT3BlbigpO1xuICAgIH0sXG4gICAgc3VibWl0Q2FsbGJhY2s6IChpbnB1dFZhbHVlcykgPT4ge1xuICAgICAgc3VibWl0QWRkQnRuLmlubmVyVGV4dCA9ICfQodC+0YXRgNCw0L3QtdC90LjQtS4uLic7XG4gICAgICBhcGkuYWRkTmV3Q2FyZCh7IHBsYWNlOiBpbnB1dFZhbHVlcy5wbGFjZSwgdXJsOiBpbnB1dFZhbHVlcy51cmwgfSlcbiAgICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgICBjb25zdCBjYXJkID0gY3JlYXRlQ2FyZChyZXMubmFtZSwgcmVzLmxpbmssIHJlcy5faWQsIHJlcy5saWtlcywgeyBvd25lZDogdHJ1ZSwgdXNlcklkOiB1c2VySWQgfSk7XG4gICAgICAgICAgY2FyZHNMaXN0LmFkZEl0ZW0oY2FyZCwgJ3RvcCcpO1xuICAgICAgICAgIHBvcHVwV2l0aEFkZENhcmRGb3JtLmNsb3NlKClcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmZpbmFsbHkocmVzID0+IHtcbiAgICAgICAgICBzdWJtaXRBZGRCdG4uaW5uZXJUZXh0ID0gJ9Ch0L7RhdGA0LDQvdC40YLRjCc7XG4gICAgICAgIH0pXG4gICAgfVxuICB9XG4pXG5wb3B1cFdpdGhBZGRDYXJkRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBQb3B1cCBJbWFnZSBoYW5kbGluZyBcbmNvbnN0IHBvcHVwV2l0aEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKCcucG9wdXBfdHlwZV9waWMnKTtcbnBvcHVwV2l0aEltYWdlLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vIFBvcHVwIHdpdGggQ29uZmltYXRpb24gaGFuZGxpbmdcbmNvbnN0IHBvcHVwV2l0aENvbmZpcm1hdGlvbiA9IG5ldyBQb3B1cFdpdGhGb3JtKCcucG9wdXBfdHlwZV9kZWxldGUtY2FyZCcsXG4gIHtcbiAgICBvcGVuQ2FsbGJhY2s6ICgpID0+IHsgfSxcbiAgICBzdWJtaXRDYWxsYmFjazogKCkgPT4ge1xuICAgICAgY29uc29sZS5sb2coJ05ldyBzdWJtaXQgaGFuZGxlciB3aWxsIGJlIG1hZGUnKTtcbiAgICB9XG4gIH0pO1xucG9wdXBXaXRoQ29uZmlybWF0aW9uLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vIEVkaXQgUHJvZmlsZSBpbWFnZSBoYW5kbGluZ1xuY29uc3QgcG9wdXBXaXRoUHJvZmlsZUltZ0VkaXRpbmcgPSBuZXcgUG9wdXBXaXRoRm9ybSgnLnBvcHVwX3R5cGVfZWRpdC1wcm9maWxlLWltZycsXG4gIHtcbiAgICBvcGVuQ2FsbGJhY2s6ICgpID0+IHtcbiAgICAgIHVwZGF0aW5nSW1hZ2VGb3JtVmFsaWRhdG9yLnZhbGlkYXRlT25PcGVuKCk7XG4gICAgfSxcbiAgICBzdWJtaXRDYWxsYmFjazogKCkgPT4ge1xuICAgICAgc3VibWl0UHJvZmlsZUltZ0J0bi5pbm5lclRleHQgPSAn0KHQvtGF0YDQsNC90LXQvdC40LUuLi4nO1xuICAgICAgYXBpLnVwZGF0ZVByb2ZpbGVJbWFnZShmb3JtSW5wdXRQcm9maWxlSW1nLnZhbHVlKVxuICAgICAgICAudGhlbihwcm9maWxlRGF0YSA9PiB7XG4gICAgICAgICAgY29uc29sZS5sb2cocHJvZmlsZURhdGEpO1xuICAgICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbWFnZShwcm9maWxlRGF0YS5hdmF0YXIpO1xuICAgICAgICAgIHBvcHVwV2l0aFByb2ZpbGVJbWdFZGl0aW5nLmNsb3NlKClcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmZpbmFsbHkocmVzID0+IHtcbiAgICAgICAgICBzdWJtaXRQcm9maWxlSW1nQnRuLmlubmVyVGV4dCA9ICfQodC+0YXRgNCw0L3QuNGC0YwnO1xuICAgICAgICB9KVxuICAgIH1cbiAgfSk7XG5wb3B1cFdpdGhQcm9maWxlSW1nRWRpdGluZy5zZXRFdmVudExpc3RlbmVycygpO1xuXG5cbi8vIEV2ZW50bGlzdGVuZXJzXG5lZGl0aW5nQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4geyBwb3B1cFdpdGhFZGl0Rm9ybS5vcGVuKCkgfSk7XG5hZGRpbmdDYXJkQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4geyBwb3B1cFdpdGhBZGRDYXJkRm9ybS5vcGVuKCkgfSk7XG5lZGl0UHJvZmlsZUltZy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsgcG9wdXBXaXRoUHJvZmlsZUltZ0VkaXRpbmcub3BlbigpIH0pXG5cbi8vIENyZWF0aW5nIGNhcmRcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVDYXJkKHRpdGxlLCB1cmwsIGlkLCBsaWtlcywgeyBvd25lZCwgdXNlcklkIH0pIHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxuICAgIHRpdGxlLFxuICAgIHVybCxcbiAgICBpZCxcbiAgICBsaWtlcyxcbiAgICB7XG4gICAgICBvd25lZCxcbiAgICAgIHVzZXJJZFxuICAgIH0sXG4gICAge1xuICAgICAgaGFuZGxlSW1hZ2VDbGljazogKGltZ1NyYywgaW1nQWx0LCB0ZXh0KSA9PiB7XG4gICAgICAgIHBvcHVwV2l0aEltYWdlLm9wZW4oaW1nU3JjLCBpbWdBbHQsIHRleHQpO1xuICAgICAgfSxcbiAgICAgIGhhbmRsZURlbGV0aW9uQ2xpY2s6IChpZCkgPT4ge1xuICAgICAgICBwb3B1cFdpdGhDb25maXJtYXRpb24ub3BlbigpXG4gICAgICAgIHBvcHVwV2l0aENvbmZpcm1hdGlvbi5jaGFuZ2VTdW1iaXRIYW5kbGVyKCgpID0+IHtcbiAgICAgICAgICBzdWJtaXRDYXJkRGVsZXRpb24uaW5uZXJUZXh0ID0gJ9Cj0LTQsNC70LXQvdC40LUuLi4nO1xuICAgICAgICAgIGFwaS5kZWxldGVDYXJkKGlkKVxuICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICBjYXJkLmRlbGV0ZUNhcmQoKTtcbiAgICAgICAgICAgICAgcG9wdXBXaXRoQ29uZmlybWF0aW9uLmNsb3NlKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICAgICAgICBzdWJtaXRDYXJkRGVsZXRpb24uaW5uZXJUZXh0ID0gJ9Ch0L7RhdGA0LDQvdC40YLRjCc7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICAgIClcbiAgICAgIH1cbiAgICB9LFxuICAgIHtcbiAgICAgIGFwaTogYXBpXG4gICAgfSxcbiAgKTtcbiAgcmV0dXJuIGNhcmQuZ2V0Q2FyZCgpO1xufSJdLCJuYW1lcyI6WyJ2YWxpZGF0aW9uRGF0YSIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXR0aW5nQnV0dG9uU2VsZWN0b3IiLCJpbnB1dEVycm9yU2VsZWN0b3IiLCJzdWJtaXR0aW5nQnV0dG9uSW52YWxpZCIsImlucHV0SW52YWxpZCIsImVycm9yVmlzaWJsZSIsIkNhcmQiLCJ0aXRsZSIsInVybCIsImlkIiwibGlrZXMiLCJvd25lZCIsInVzZXJJZCIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVEZWxldGlvbkNsaWNrIiwiYXBpIiwiX2xpa2VCdG4iLCJjbGFzc0xpc3QiLCJjb250YWlucyIsIl9hcGkiLCJ1bmxpa2VDYXJkIiwiX2lkIiwidGhlbiIsInJlcyIsInJlbW92ZSIsIl9saWtlc0NvdW50IiwibGVuZ3RoIiwiX3NldExpa2VDb3VudCIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImxpa2VDYXJkIiwiYWRkIiwiX2hhbmRsZURlbGV0aW9uQ2xpY2siLCJ0aGlzIiwiX3RpdGxlIiwiX3VybCIsIl9saWtlcyIsIl9vd25lZCIsIl91c2VySWQiLCJfdGVtcGxhdGVTZWxlY3RvciIsIl90ZW1wbGF0ZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJfY2FyZCIsImNsb25lTm9kZSIsIl90ZXh0IiwiX2ltZyIsIl9yZW1vdmVCdG4iLCJfbGlrZUNvdW50IiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfaW5zZXJ0RGF0YSIsIl90b2dnbGVEZWxldGVCdG5JZk93bmVkIiwiX2NoZWNrSWZMaWtlZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJzcmMiLCJhbHQiLCJ0ZXh0Q29udGVudCIsIl90b2dnbGVMaWtlIiwiX2NsaWNrUmVtb3ZlIiwiZm9yRWFjaCIsImxpa2UiLCJfYmxhY2tlbkxpa2UiLCJzdHlsZSIsImRpc3BsYXkiLCJfY3JlYXRlQ2FyZCIsIkZvcm1WYWxpZGF0b3IiLCJ2YWxpZGF0aW9uT2JqZWN0IiwiX3ZhbGlkYXRpb25EYXRhIiwiX3ZhbGlkYXRpb25PYmplY3QiLCJfc3VibWl0dGluZ0J1dHRvbiIsIl9pbnB1dExpc3QiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3NldEV2ZW50TGlzdGVuZXIiLCJldmVyeSIsImlucHV0RWxlbWVudCIsInZhbHVlIiwiX3RvZ2dsZVN1Ym1pdFN0YXRlIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsImVycm9yTWVzc2FnZSIsImVycm9yRWxlbWVudCIsIm5hbWUiLCJfY2hlY2tJZkFsbElucHV0SXNWYWxpZCIsInJlbW92ZUF0dHJpYnV0ZSIsInNldEF0dHJpYnV0ZSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIlBvcHVwIiwic2VsZWN0b3IiLCJfc2VsZWN0b3IiLCJfcG9wdXAiLCJfcG9wdXBDbG9zZUJ0biIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZ0IiwidGFyZ2V0IiwiY3VycmVudFRhcmdldCIsImNsb3NlIiwia2V5IiwiUG9wdXBXaXRoSW1hZ2UiLCJpbWdTcmMiLCJpbWdBbHQiLCJ0ZXh0IiwiU2VjdGlvbiIsInJlbmRlcmVyIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsIml0ZW1zIiwiaXRlbSIsInBvcyIsInByZXBlbmQiLCJhcHBlbmQiLCJQb3B1cFdpdGhGb3JtIiwib3BlbkNhbGxiYWNrIiwic3VibWl0Q2FsbGJhY2siLCJfb3BlbkNhbGxiYWNrIiwiX3N1Ym1pdENhbGxiYWNrIiwiX2Zvcm0iLCJfZm9ybUlucHV0cyIsInByZXZlbnREZWZhdWx0Iiwic3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uIiwiX2dldElucHV0VmFsdWVzIiwibmV3U3VibWl0SGFuZGVsZXIiLCJyZXNldCIsImlucHV0VmFsdWVzIiwiZm9ybUlucHV0IiwidmFsIiwiVXNlckluZm8iLCJwcm9maWxlTmFtZVNlbCIsInByb2ZpbGVKb2JTZWwiLCJwcm9maWxlSW1hZ2VTZWwiLCJfcHJvZmlsZU5hbWUiLCJfcHJvZmlsZUpvYiIsIl9wcm9maWxlSW1nIiwiam9iIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiX3Rva2VuIiwiYXV0aG9yaXphdGlvbiIsImZldGNoIiwiX2NoZWNrUmVzcG9uc2UiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFib3V0IiwicGxhY2UiLCJsaW5rIiwiYXZhdGFyIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImVkaXRpbmdCdG4iLCJhZGRpbmdDYXJkQnRuIiwiZWRpdFByb2ZpbGVJbWciLCJwb3B1cEVkaXRQcm9maWxlSW1nIiwiZm9ybUlucHV0UHJvZmlsZUltZyIsImVkaXRQcm9maWxlSW1nRm9ybSIsInN1Ym1pdFByb2ZpbGVJbWdCdG4iLCJwb3B1cEVkaXRDYXJkIiwiZWRpdGluZ0Zvcm0iLCJpbnB1dE5hbWUiLCJpbnB1dEpvYiIsInN1Ym1pdEVkaXRCdG4iLCJwb3B1cEFkZENhcmQiLCJhZGRpbmdGb3JtIiwic3VibWl0QWRkQnRuIiwiY2FyZHNDb250YWluZXJTZWwiLCJlZGl0aW5nRm9ybVZhbGlkYXRvciIsImFkZGluZ0Zvcm1WYWxpZGF0b3IiLCJ1cGRhdGluZ0ltYWdlRm9ybVZhbGlkYXRvciIsInN1Ym1pdENhcmREZWxldGlvbiIsImNhcmRzTGlzdCIsImVuYWJsZVZhbGlkYXRpb24iLCJ1c2VySW5mbyIsImFsbCIsImdldFByb2ZpbGVEYXRhIiwiZ2V0SW5pdGlhbENhcmRzIiwicHJvZmlsZURhdGEiLCJpbml0aWFsQ2FyZHMiLCJzZXRVc2VySW5mbyIsInNldFVzZXJJbWFnZSIsImNhcmRJdGVtIiwib3duZXIiLCJjYXJkIiwiY3JlYXRlQ2FyZCIsImFkZEl0ZW0iLCJyZW5kZXJJdGVtcyIsInNldEluaXRpYWxDYXJkcyIsInBvcHVwV2l0aEVkaXRGb3JtIiwidXNlckluZm9EYXRhIiwiZ2V0VXNlckluZm8iLCJ2YWxpZGF0ZU9uT3BlbiIsImlubmVyVGV4dCIsInNldFByb2ZpbGVEYXRhIiwiZmluYWxseSIsInNldEV2ZW50TGlzdGVuZXJzIiwicG9wdXBXaXRoQWRkQ2FyZEZvcm0iLCJhZGROZXdDYXJkIiwicG9wdXBXaXRoSW1hZ2UiLCJwb3B1cFdpdGhDb25maXJtYXRpb24iLCJwb3B1cFdpdGhQcm9maWxlSW1nRWRpdGluZyIsInVwZGF0ZVByb2ZpbGVJbWFnZSIsIm9wZW4iLCJjaGFuZ2VTdW1iaXRIYW5kbGVyIiwiZGVsZXRlQ2FyZCIsImdldENhcmQiXSwic291cmNlUm9vdCI6IiJ9